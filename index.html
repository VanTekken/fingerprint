<!DOCTYPE html>
<html>
    <head>
        <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
        <meta content="utf-8" http-equiv="encoding" />
    </head>
    <body>
        <script src="polyfill.min.js"></script>
        <script async src="fp.min.js" onload="initFingerprintJS()"></script>

        <script>
            function initFingerprintJS() {
                const d1 = new Date();

                FingerprintJS.load().then(function (fp) {
                    fp.get().then(function (result) {
                        const d2 = new Date();

                        const visitorId = result.visitorId;
                        const userAgentString = navigator.userAgent;
                        const timeString =
                            "Time to calculate the fingerprint: " +
                            (d2 - d1) +
                            "ms";

                        let postObj = {
                            userAgentString: userAgentString,
                            visitorId: visitorId,
                            timeString,
                        };

                        var details = "";
                        if (typeof window.console !== "undefined") {
                            for (var index in result.components) {
                                const obj = result.components[index];
                                const value = obj.value;
                                if (value) {
                                    postObj[index] = JSON.stringify(
                                        value
                                    ).substr(0, 150);
                                }
                            }
                        }

                        console.log(postObj);
                        let post = JSON.stringify(postObj);
                        const url = "/skl.php";
                        let xhr = new XMLHttpRequest();

                        xhr.open("POST", url, true);
                        xhr.setRequestHeader(
                            "Content-type",
                            "application/json; charset=UTF-8"
                        );
                        xhr.send(post);
                    });
                });
            }
        </script>
    </body>
</html>
